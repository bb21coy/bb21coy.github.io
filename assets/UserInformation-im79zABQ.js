import{r as o,j as e,R as V}from"./index-CmEGY9Xn.js";import{P as u}from"./index-Co4oEsvj.js";import{a as _}from"./index-NIGUFBhG.js";import{s as x,h as L}from"./handleServerError-BHmHb0ds.js";import{B as N}from"./Constants-B3OfrIZX.js";const Y=({account_type:d,appointment:P,reLoad:j})=>{const[s,m]=o.useState("Boy"),[t,h]=o.useState("REC"),[v,f]=o.useState("1"),[i,g]=o.useState("VAL"),[T,b]=o.useState("Mr"),[C,F]=o.useState(!0);function E(a){m(a.target.value),document.getElementById("account-type-input").value=a.target.value,(a.target.value==="Primer"||a.target.value==="Officer")&&h("NIL")}function y(a){a.preventDefault();let p=!0;s!=="Boy"&&a.target.elements.credentials.value===""&&(p=!1),(a.target.elements.user_name.value===""||a.target.elements.password.value==="")&&(p=!1),p?_.post(`${N}/account`,{account_name:a.target.elements.account_name.value,user_name:a.target.elements.user_name.value,abbreviated_name:a.target.elements.abbreviated_name.value,password:a.target.elements.password.value,account_type:s,rank:t==="NIL"?"":t,level:s==="Boy"?v:"",class1:s==="Officer"?i:"",credentials:s!=="Boy"?a.target.elements.credentials.value:"",honorifics:s==="Officer"&&(t==="NIL"||i==="STAFF")?T:"",roll_call:C},{headers:{"x-route":"/create_account"},withCredentials:!0}).then(()=>{x("Account has been created","success"),a.target.elements.account_name.value="",a.target.elements.user_name.value="",a.target.elements.abbreviated_name.value="",a.target.elements.password.value="",j()}).catch(A=>{console.error("Error creating account:",A.response.data),L(A.response.status)}):x("Some fields are missing. Please try again.")}return e.jsxs("form",{className:"create-account-form",onSubmit:y,children:[e.jsx("h2",{children:"Account Creation"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full-name-input",children:"Full Name:"}),e.jsx("input",{name:"account_name",placeholder:"Enter Full Name",id:"full-name-input"}),e.jsx("label",{htmlFor:"user-name-input",children:"User Name:"}),e.jsx("input",{name:"user_name",placeholder:"Enter User Name",id:"user-name-input"}),e.jsx("label",{htmlFor:"abbreviated-name-input",children:"Abbreviated Name:"}),e.jsx("input",{name:"abbreviated_name",placeholder:"Enter Abbreviated Name",id:"abbreviated-name-input"}),e.jsx("label",{htmlFor:"password-input",children:"Password:"}),e.jsx("input",{name:"password",placeholder:"Enter Password",autoComplete:"new-password",id:"password-input"}),e.jsx("label",{htmlFor:"account-type-input",children:"Account Type: "}),e.jsxs("select",{name:"account-type",id:"account-type-input",onChange:a=>E(a),defaultValue:"Boy",children:[["Admin","Officer"].includes(d)&&e.jsx("option",{value:"Officer",children:"Officer"}),["Admin","Officer","Primer"].includes(d)&&e.jsx("option",{value:"Primer",children:"Primer"}),e.jsx("option",{value:"Boy",children:"Boy"})]}),s&&e.jsx("label",{htmlFor:"rank-input",children:"Rank: "}),["Officer","Primer","Boy"].includes(s)&&e.jsxs("select",{id:"rank-input",onChange:a=>h(a.target.value),defaultValue:s==="Boy"?"REC":"NIL",children:[s==="Officer"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"NIL",children:"Not Applicable"}),e.jsx("option",{value:"OCT",children:"OCT"}),e.jsx("option",{value:"2LT",children:"2LT"}),e.jsx("option",{value:"LTA",children:"LTA"})]}),s==="Primer"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"NIL",children:"Not Applicable"}),e.jsx("option",{value:"CLT",children:"CLT"}),e.jsx("option",{value:"SCL",children:"SCL"})]}),s==="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"REC",children:"REC"}),e.jsx("option",{value:"PTE",children:"PTE"}),e.jsx("option",{value:"LCP",children:"LCP"}),e.jsx("option",{value:"CPL",children:"CPL"}),e.jsx("option",{value:"SGT",children:"SGT"}),e.jsx("option",{value:"SSG",children:"SSG"}),e.jsx("option",{value:"WO",children:"WO"})]})]}),(["Admin","Officer"].includes(d)||P==="CSM")&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"roll-call-input",children:"Attendance Appearance:"}),e.jsxs("select",{id:"roll-call-input",onChange:a=>F(a.target.value==="Yes"),defaultValue:"Yes",children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]})]}),(i==="STAFF"||t==="NIL")&&s==="Officer"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"honorific-input",children:"Honorifics:"}),e.jsxs("select",{id:"honorific-input",onChange:a=>b(a.target.value),children:[e.jsx("option",{value:"Mr",children:"Mr"}),e.jsx("option",{value:"Ms",children:"Ms"}),e.jsx("option",{value:"Mrs",children:"Mrs"})]})]}),s==="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"level-input",children:"Level:"}),e.jsxs("select",{id:"level-input",onChange:a=>f(a.target.value),defaultValue:"1",children:[e.jsx("option",{value:"1",children:"Secondary 1"}),e.jsx("option",{value:"2",children:"Secondary 2"}),e.jsx("option",{value:"3",children:"Secondary 3"}),e.jsx("option",{value:"4",children:"Secondary 4"}),e.jsx("option",{value:"5",children:"Secondary 5"})]})]}),s==="Officer"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"class-input",children:"Class:"}),e.jsxs("select",{id:"class-input",onChange:a=>g(a.target.value),defaultValue:"VAL",children:[e.jsx("option",{value:"VAL",children:"VAL"}),e.jsx("option",{value:"STAFF",children:"STAFF"}),e.jsx("option",{value:"UNI",children:"UNI"}),e.jsx("option",{value:"POLY",children:"POLY"})]})]}),["Officer","Primer"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"credentials-input",children:"Credentials (For 32A results): "}),e.jsx("input",{className:"account-credentials",name:"credentials",placeholder:"Enter Credentials",id:"credentials-input"})]})]}),e.jsx("button",{children:"Create Account"})]})};Y.propTypes={account_type:u.string,appointment:u.string,reLoad:u.func};const $=({accountType:d,appointment:P,userId:j,showForm:s,reLoad:m})=>{const[t,h]=o.useState(),[v,f]=o.useState(),[i,g]=o.useState(),[T,b]=o.useState(),[C,F]=o.useState(!1),[E,y]=o.useState(),[a,p]=o.useState(!0),[A,S]=o.useState({1:null,2:null,3:null,4:null,5:null});o.useEffect(()=>{h(null),_.get(`${N}/account/?id=${j}`,{headers:{"x-route":"/get_account"},withCredentials:!0}).then(n=>{h(n.data),f(n.data.rank??null),g(n.data.level),b(n.data.class_1),F(n.data.graduated),y(n.data.honorifics),p(n.data.roll_call),S(c=>{let l={...c};for(let r=1;r<=5;r++)l[r]=n.data[`rank${r}`];return l})}).catch(n=>{console.error(n.response.data),L(n.response.status)})},[j]);function w(n){f(n.target.value!=="NIL"?n.target.value:null),t.account_type==="Boy"&&S(c=>{let l={...c};return l[i]=n.target.value,l})}function k(n,c){S(l=>{let r={...l};return r[n]=c.target.value,r})}function B(n){g(n.target.value),t.account_type==="Boy"&&S(c=>{let l={...c};l[parseInt(n.target.value)]=v;for(let r=parseInt(n.target.value)+1;r<=5;r++)l[r]=null;return l})}function I(n){F(n.target.value==="Yes"),p(t.roll_call)}function M(n){n.preventDefault();let c=null,l=null,r=!0;t.account_type==="Boy"?(c=i,isNaN(parseInt(c))&&(r=!1)):(l=n.target.elements.credentials.value,l===""&&(r=!1)),n.target.elements.account_name.value===""&&(r=!1);const O=new FormData(n.target);O.append("id",t._id),r?_.put(`${N}/account`,O,{headers:{"x-route":"/update_account"},withCredentials:!0}).then(()=>{x("Account has been updated","success"),m()}).catch(R=>{console.error(R.response.data),L(R.response.status)}):x("Please fill in all fields first")}function G(n){_.delete(`${N}/account?id=${t._id}`,{headers:{"x-route":"/delete_account"},withCredentials:!0}).then(()=>{x("Account has been deleted","success"),s(),m()}).catch(c=>{m(),console.error(c.response.data),L(c.response.status)})}return e.jsxs("div",{className:"user-information",children:[e.jsxs("h2",{children:["User - ",t?t.account_name:""]}),t!=null&&e.jsxs("form",{className:"edit-account-form",id:"edit-account-form",onSubmit:M,"data-testid":"user-information-form",children:[e.jsx("label",{htmlFor:"name-input",children:"Name:"}),e.jsx("input",{id:"name-input",name:"account_name",defaultValue:t.account_name,placeholder:"Enter Name"}),d==="Admin"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"user-name-input",children:"User Name:"}),e.jsx("input",{id:"user-name-input",name:"user_name",defaultValue:t.user_name,placeholder:"Enter User Name"})]}),e.jsx("label",{htmlFor:"abb-name-input",children:"Abbreviated Name:"}),e.jsx("input",{id:"abb-name-input",name:"abbreviated_name",defaultValue:t.abbreviated_name,placeholder:"Enter Abbreviated Name"}),d==="Admin"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"password-input",children:"New Password:"}),e.jsx("input",{name:"password",defaultValue:t.password_digest,id:"password-input",placeholder:"Enter Password"})]}),e.jsx("label",{htmlFor:"account-type-input",children:"Account Type:"}),e.jsx("select",{id:"account-type-input",defaultValue:t.account_type,disabled:!0,children:e.jsx("option",{value:t.account_type,children:t.account_type})}),e.jsx("input",{type:"hidden",name:"account_type",value:t.account_type}),e.jsx("label",{htmlFor:"rank-input",children:"Rank:"}),e.jsxs("select",{id:"rank-input",name:"rank",defaultValue:t.rank,onChange:w,children:[t.account_type==="Officer"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"NIL",children:"Not Applicable"}),e.jsx("option",{value:"OCT",children:"OCT"}),e.jsx("option",{value:"2LT",children:"2LT"}),e.jsx("option",{value:"LTA",children:"LTA"})]}),t.account_type==="Primer"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"NIL",children:"Not Applicable"}),e.jsx("option",{value:"CLT",children:"CLT"}),e.jsx("option",{value:"SCL",children:"SCL"})]}),t.account_type==="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"REC",children:"REC"}),e.jsx("option",{value:"PTE",children:"PTE"}),e.jsx("option",{value:"LCP",children:"LCP"}),e.jsx("option",{value:"CPL",children:"CPL"}),e.jsx("option",{value:"SGT",children:"SGT"}),e.jsx("option",{value:"SSG",children:"SSG"}),e.jsx("option",{value:"WO",children:"WO"})]})]}),(["Admin","Officer"].includes(d)||P==="CSM")&&!C&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"attendance-appearance",children:"Attendance Appearance:"}),e.jsxs("select",{id:"attendance-appearance",name:"roll_call",defaultValue:a?"Yes":"No",onChange:n=>p(n.target.value==="Yes"),children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]})]}),t.account_type==="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"member-id-input",children:"Member ID:"}),e.jsx("input",{name:"member_id",id:"member-id-input",defaultValue:t.member_id,placeholder:"Enter Member ID"})]}),t.account_type==="Boy"&&!C&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"secondary-input",children:"Secondary:"}),e.jsxs("select",{id:"secondary-input",name:"level",onChange:B,defaultValue:t.level,children:[e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"1",children:"1"})]})]}),t.account_type==="Boy"&&(()=>{const n=parseInt(i);if(!isNaN(n))return Array.from({length:n},(c,l)=>e.jsxs(V.Fragment,{children:[e.jsxs("label",{htmlFor:`sec-${l+1}-class`,children:["Sec ",l+1," Class:"]}),e.jsx("input",{id:`sec-${l+1}-class`,name:"class"+(l+1),defaultValue:t[`class${l+1}`]||"",placeholder:`Enter Sec ${l+1} Class`})]},l))})(),t.account_type==="Boy"&&(()=>{const n=parseInt(i);if(!isNaN(n))return Array.from({length:n-1},(c,l)=>e.jsxs(V.Fragment,{children:[e.jsxs("label",{htmlFor:`sec-${l+1}-rank`,children:["End of Sec ",l+1," Rank:"]}),e.jsxs("select",{id:`sec-${l+1}-rank`,name:"rank"+(l+1),onChange:r=>k(l+1,r),defaultValue:A[l+1]||"",children:[e.jsx("option",{value:"",disabled:!0,children:"-"}),e.jsx("option",{value:"REC",children:"REC"}),e.jsx("option",{value:"PTE",children:"PTE"}),e.jsx("option",{value:"LCP",children:"LCP"}),e.jsx("option",{value:"CPL",children:"CPL"}),e.jsx("option",{value:"SGT",children:"SGT"}),e.jsx("option",{value:"SSG",children:"SSG"}),e.jsx("option",{value:"WO",children:"WO"})]})]},l))})(),t.account_type==="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"graduated-input",children:"Graduated:"}),e.jsxs("select",{id:"graduated-input",name:"graduated",defaultValue:t.graduated?"Yes":"No",onChange:I,children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]})]}),t.appointment!=null&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"appointment-input",children:"Appointment:"}),e.jsx("input",{type:"text",name:"appointment",id:"appointment-input",disabled:!0,defaultValue:t.appointment})]}),(t.class_1?.toLowerCase()==="staff"||v===null)&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"honorific-input",children:"Honorifics:"}),e.jsxs("select",{id:"honorific-input",name:"honorifics",onChange:n=>y(n.target.value),defaultValue:E,children:[e.jsx("option",{value:"",children:"-"}),e.jsx("option",{value:"Mr",children:"Mr"}),e.jsx("option",{value:"Ms",children:"Ms"}),e.jsx("option",{value:"Mrs",children:"Mrs"})]})]}),(t.account_type==="Primer"&&t.rank===null||t.account_type==="Officer")&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"class-input",children:"Class:"}),e.jsxs("select",{id:"class-input",name:"class_1",onChange:n=>b(n.target.value),defaultValue:T,placeholder:"Enter Class",children:[e.jsx("option",{value:"VAL",children:"VAL"}),e.jsx("option",{value:"STAFF",children:"STAFF"}),e.jsx("option",{value:"UNI",children:"UNI"}),e.jsx("option",{value:"POLY",children:"POLY"})]})]}),t.account_type!=="Boy"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"credentials-input",children:"Credentials (For 32A results):"}),e.jsx("input",{name:"credentials",defaultValue:t.credentials,id:"credentials-input"})]})]}),e.jsxs("div",{children:[e.jsx("button",{className:"edit-button",type:"submit",form:"edit-account-form",children:"Save Changes"}),e.jsx("button",{className:"delete-button",type:"button",onClick:G,children:"Delete Account"})]})]})};$.propTypes={accountType:u.string,appointment:u.string,userId:u.string.isRequired,showForm:u.func,reLoad:u.func};export{Y as A,$ as U};
