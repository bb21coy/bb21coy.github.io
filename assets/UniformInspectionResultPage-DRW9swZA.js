import{r as n,d as R,j as s}from"./index-CmEGY9Xn.js";import{a as l}from"./index-NIGUFBhG.js";import{h}from"./handleServerError-BHmHb0ds.js";const $=()=>{const[d,x]=n.useState([]),[j,f]=n.useState({}),[a,c]=n.useState(),[i,u]=n.useState(),[g,_]=n.useState(),[m,k]=n.useState([]),[p,v]=n.useState([]),[y,I]=n.useState(),{id:r}=R();l.post("/application/0/check_session",{},{withCredentials:!0}).then(e=>{e.data.user?.account_type=="Boy"&&(window.location.href="/home")}).catch(()=>{window.location.href="/"}),n.useEffect(()=>{l.post("/api/uniform_inspection/0/get_component_fields",{},{withCredentials:!0}).then(e=>{x(e.data.components),f(e.data)}).catch(e=>h(e.response.status)),l.post("/api/uniform_inspection/"+r+"/get_inspection",{id:r}).then(e=>{let t={};e.data.remarks.map(o=>{t[o.component_id]=o}),v(t),_(e.data.inspections),u(e.data.inspections[e.data.boy.id]),c(e.data.inspections[e.data.boy.id][r]),k(e.data.boys),I(e.data.boy.id)}).catch(e=>h(e.response.status))},[]);function b(e){c(i[e.target.value])}function S(e){let t=g[e.target.value],o=t.inspections[0];u(t),c(t[o.id]),d.forEach(C=>{const w=document.getElementsByTagName("textarea");Array.from(w).forEach(E=>{E.value=p[C.id]?.remark??""})})}return s.jsx("div",{className:"uniform-inspection-result-page",children:s.jsxs("div",{className:"page-container",children:[s.jsx("h2",{children:"Past Inspection Results"}),s.jsxs("div",{children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"boy-select",children:"Viewing Results of:"}),m.length!=0&&s.jsx("select",{onChange:S,id:"boy-select",defaultValue:y,children:m.map(e=>s.jsxs("option",{value:e.id,children:[e.rank," ",e.account_name]},e.id))}),s.jsx("label",{htmlFor:"inspection-select",children:"On"}),i!=null&&i.inspections.length!=0&&s.jsx("select",{className:"date-select",id:"inspection-select",onChange:b,children:i.inspections.map(e=>s.jsx("option",{value:e.id,children:e.date},e.id))})]}),s.jsx("div",{children:a!=null&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Assessor: ",a.assessor.rank," ",a.assessor.account_name]}),s.jsxs("p",{children:["Score: ",a.inspection.total_score]})]})})]}),a!=null&&d.map(e=>s.jsxs("div",{children:[s.jsx("h3",{children:e.component_name}),s.jsx("ul",{children:j[e.component_name].map(t=>s.jsxs("li",{children:[s.jsx("input",{type:"checkbox",disabled:!0,id:`${t.id}-field`,checked:a.selected_components[t.id]!=null,className:`${t.description.toLowerCase().includes("missing")?"field-missing":""}`}),s.jsx("label",{htmlFor:`${t.id}-field`,children:t.description})]},t.id))}),s.jsx("textarea",{name:`${e.component_name}-remarks`,placeholder:"Components Remarks (if any)",defaultValue:p[e.id]?.remarks??"No Remarks Given",disabled:!0})]},e.id))]})})};export{$ as UniformInspectionResultPage};
