import{r,j as e,R as b,u as T}from"./index-CmEGY9Xn.js";import{a as p}from"./index-NIGUFBhG.js";import{A as $,U as k}from"./UserInformation-im79zABQ.js";import{P as a}from"./index-Co4oEsvj.js";import{s as S,h as m}from"./handleServerError-BHmHb0ds.js";import{B as h}from"./Constants-B3OfrIZX.js";const L=({accountType:o,appointment:s,reLoad:d,boyList:c,primerList:t,officerList:u})=>{const _=["Captain","CSM","DY CSM","Sec 4/5 PS","Sec 3 PS","Sec 2 PS","Sec 1 PS"],[g,j]=r.useState();function f(){g===s.account_id||g==null||p.put(`${h}/appointment`,{appointment_id:s._id,account_id:g},{headers:{"x-route":"/update_appointment"},withCredentials:!0}).then(()=>{d(),S("Appointment holder has been updated.","success")}).catch(i=>{console.log(i.response.data),m(i.response.status)})}function y(){p.delete(`${h}/appointment?id=${s._id}`,{headers:{"x-route":"/delete_appointment"},withCredentials:!0}).then(()=>{d(),S("Appointment has been removed.","success")}).catch(i=>{console.error(i.response.data),m(i.response.status)})}return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:s._id,children:[s.appointment_name,":"]}),e.jsxs("select",{id:s._id,defaultValue:s.account_id,onChange:i=>j(i.target.value),children:[e.jsx("option",{value:s.account_id,children:s.account_name}),["Officer","Admin"].includes(o)&&(s.account_type==="Officer"?u:s.account_type==="Primer"?t:c).filter(i=>i._id!==s.account_id).map(i=>e.jsx("option",{value:i._id,children:i.account_name},i._id))]}),e.jsxs("div",{children:[["Officer","Admin"].includes(o)&&e.jsx("button",{id:s.id,className:s.appointment_name,onClick:f,children:"Update"}),["Officer","Admin"].includes(o)&&!_.includes(s.appointment_name)&&e.jsx("button",{onClick:y,children:"Remove"})]})]})};L.propTypes={accountType:a.string,appointment:a.shape(),boyList:a.arrayOf(a.shape({id:a.number,account_name:a.string})),primerList:a.arrayOf(a.shape({id:a.number,account_name:a.string})),officerList:a.arrayOf(a.shape({id:a.number,account_name:a.string}))};const P=({account_type:o,load:s,reLoad:d})=>{const[c,t]=r.useState([]),[u,_]=r.useState([]),[g,j]=r.useState([]),[f,y]=r.useState([]),[i,C]=r.useState();r.useEffect(()=>{p.get(`${h}/appointment`,{headers:{"x-route":"/get_appointments"},withCredentials:!0}).then(n=>{t(n.data)}).catch(n=>{console.error("Error fetching appointments:",n.data),m(n.response.status)}),p.get(`${h}/account?type=Boy`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(n=>_(n.data)).catch(n=>m(n.response.status)),p.get(`${h}/account?type=Primer`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(n=>j(n.data)).catch(n=>m(n.response.status)),p.get(`${h}/account?type=Officer`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(n=>y(n.data)).catch(n=>m(n.response.status))},[s]);function A(n){if(n.preventDefault(),!n.target.checkValidity())return S("Please fill in all fields");const v=new FormData(n.target);p.post(`${h}/appointment`,v,{headers:{"x-route":"/create_appointment"},withCredentials:!0}).then(()=>{d(),S("Appointment has been created.","success")}).catch(x=>{console.error(x.response.data),m(x.response.status)})}return e.jsxs("div",{className:"appointment-holders-list",children:[e.jsx("h2",{children:"Appointment Holders"}),e.jsx("div",{className:"appointment-holders-users",children:c.map(n=>e.jsx(L,{accountType:o,appointment:n,boyList:u,primerList:g,officerList:f,reLoad:d},n._id))}),(o==="Officer"||o==="Admin")&&e.jsxs("form",{onSubmit:A,noValidate:!0,children:[e.jsx("h3",{children:"Add Appointment"}),e.jsx("label",{htmlFor:"name",children:"Appointment Name:"}),e.jsx("input",{placeholder:"Enter Appointment Name",type:"text",id:"name",autoComplete:"off",required:!0,name:"appointment_name"}),e.jsx("label",{htmlFor:"account-type",children:"Account Type: "}),e.jsxs("select",{id:"account-type",defaultValue:"",required:!0,onChange:n=>C(n.target.value),name:"account_type",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Account Type"}),e.jsx("option",{value:"Officer",children:"Officer"}),e.jsx("option",{value:"Primer",children:"Primer"}),e.jsx("option",{value:"Boy",children:"Boy"})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"holder",children:"Appointment Holder:"}),e.jsxs("select",{id:"holder",defaultValue:"",required:!0,name:"account_id",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Appointment Holder"}),(i==="Officer"?f:i==="Primer"?g:u).map(n=>e.jsx("option",{value:n._id,children:n.account_name},n._id))]})]}),e.jsx("button",{children:"Add New Appointment"})]})]})};P.propTypes={account_type:a.string,load:a.bool.isRequired,reLoad:a.func.isRequired};const E=({setPageState:o,load:s})=>{const[d,c]=r.useState([]);return r.useEffect(()=>{p.get(`${h}/account?type=Officer`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(t=>c(t.data)).catch(t=>{console.error("Error fetching officers:",t.response.data),m(t.response.status)})},[s]),e.jsx(e.Fragment,{children:d.map(t=>e.jsxs(b.Fragment,{children:[e.jsx("input",{type:"radio",name:"users-list",id:t._id,onChange:u=>o(u.target.id)}),e.jsxs("label",{htmlFor:t._id,children:[t.account_type," ",t.rank," ",t.account_name]})]},t._id))})};E.propTypes={setPageState:a.func.isRequired,load:a.bool.isRequired};const O=({setPageState:o,load:s})=>{const[d,c]=r.useState([]);return r.useEffect(()=>{p.get(`${h}/account?type=Primer`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(t=>c(t.data)).catch(t=>{console.error("Error fetching primers:",t.response.data),m(t.response.status)})},[s]),e.jsx(e.Fragment,{children:d.map(t=>e.jsxs(b.Fragment,{children:[e.jsx("input",{type:"radio",name:"users-list",id:t._id,onChange:u=>o(u.target.id)}),e.jsxs("label",{htmlFor:t._id,children:[t.account_type," ",t.rank," ",t.account_name]})]},t._id))})};O.propTypes={setPageState:a.func.isRequired,load:a.bool.isRequired};const B=({setPageState:o,load:s})=>{const[d,c]=r.useState([]);return r.useEffect(()=>{p.get(`${h}/account?type=Boy`,{headers:{"x-route":"/get_accounts_by_type"},withCredentials:!0}).then(t=>c(t.data)).catch(t=>{console.error("Error fetching boys:",t.response.data),m(t.response.status)})},[s]),e.jsx(e.Fragment,{children:d.filter(t=>t.graduated!==!0).map(t=>e.jsxs(b.Fragment,{children:[e.jsx("input",{type:"radio",name:"users-list",id:t._id,onChange:u=>o(u.target.id)}),e.jsxs("label",{htmlFor:t._id,children:[t.account_type," Sec ",t.level," ",t.rank," ",t.account_name]})]},t._id))})};B.propTypes={setPageState:a.func.isRequired,load:a.bool.isRequired};const N=({setPageState:o,load:s})=>{const[d,c]=r.useState([]);return r.useEffect(()=>{p.get(`${h}/account`,{headers:{"x-route":"/get_graduated_accounts"},withCredentials:!0}).then(t=>c(t.data)).catch(t=>{console.error("Error fetching boys:",t.response.data),m(t.response.status)})},[s]),e.jsx(e.Fragment,{children:d.map(t=>e.jsxs(b.Fragment,{children:[e.jsx("input",{type:"radio",name:"users-list",id:t._id,onChange:u=>o(u.target.id)}),e.jsxs("label",{htmlFor:t._id,children:[t.account_type," Sec ",t.level," ",t.rank," ",t.account_name]})]},t._id))})};N.propTypes={setPageState:a.func.isRequired,load:a.bool.isRequired};const z=()=>{const o=T(),[s,d]=r.useState(!0),[c,t]=r.useState("form"),[u,_]=r.useState(null),[g,j]=r.useState(window.innerWidth>800),[f,y]=r.useState(),[i,C]=r.useState();r.useEffect(()=>{window.addEventListener("resize",()=>{j(window.innerWidth>800)}),p.get(`${h}/account`,{headers:{"x-route":"/get_own_account"},withCredentials:!0}).then(l=>{l.data.account_type==="Boy"&&l.data.appointment===null&&o("/home"),y(l.data.account_type),C(l.data.appointment)}).catch(l=>{console.error("Error fetching user information: ",l.response.data),S("Failed to load user information")})},[o]);function A(){g?t("form"):o("/user_management/0")}const n=()=>t("form"),v=()=>t("appointments");function x(l){g?(t("user"),_(l)):o("/user_management/"+encodeURIComponent(l))}function w(){d(l=>!l)}function R(){const l=document.getElementById("search").value.toLowerCase();document.querySelectorAll("#all-users label").forEach(F=>{const q=F.textContent.toLowerCase();F.style.display=q.includes(l)?"block":"none"})}return e.jsx("div",{className:"user-management-page",children:e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"toggle-buttons",children:[e.jsx("input",{type:"radio",name:"toggle-buttons",id:"users",onChange:n,checked:c!=="appointments"}),e.jsx("label",{htmlFor:"users",children:"Users"}),e.jsx("input",{type:"radio",name:"toggle-buttons",id:"appt",onChange:v,checked:c==="appointments"}),e.jsx("label",{htmlFor:"appt",children:"Appointment Holders"})]}),e.jsxs("div",{className:"users",children:[c!=="appointments"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"users-list",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"search",children:[e.jsx("i",{className:"fa-solid fa-magnifying-glass"}),"Search"]}),e.jsx("input",{type:"search",name:"search",id:"search",placeholder:"Search by Name",onInput:R})]}),e.jsx("button",{onClick:A,children:"Create New Account"})]}),e.jsxs("div",{id:"all-users",children:[e.jsx("p",{children:"Current Users"}),["Admin","Officer"].includes(f)&&e.jsx(E,{setPageState:x,load:s}),f!=="Boy"&&e.jsx(O,{setPageState:x,load:s}),e.jsx(B,{setPageState:x,load:s}),e.jsx("p",{children:"Graduated Boys"}),e.jsx(N,{setPageState:x,load:s})]})]}),e.jsx("hr",{})]}),e.jsxs("div",{className:"main-block",children:[c==="form"&&e.jsx($,{account_type:f,appointment:i,reLoad:w}),c==="appointments"&&e.jsx(P,{account_type:f,load:s,reLoad:w}),c==="user"&&e.jsx(k,{accountType:f,appointment:i,userId:u,showForm:A,reLoad:w})]})]})]})})};export{z as UserManagementPage};
