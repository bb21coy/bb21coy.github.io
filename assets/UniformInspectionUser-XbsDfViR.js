import{r as n,j as e,R as f}from"./index-D47I_7n0.js";import{a as c}from"./index-NIGUFBhG.js";import{h as d}from"./handleServerError-BHmHb0ds.js";function w(){const[o,l]=n.useState([]),[i,p]=n.useState(),[m,h]=n.useState([]),[x,u]=n.useState({});n.useEffect(()=>{c.post("/application/0/check_session",{},{withCredentials:!0}).then(t=>{t.data.user?.account_type!="Boy"&&(window.location.href="/home"),c.get("/api/uniform_inspection/0/get_user_inspection_results",{withCredentials:!0}).then(s=>l(s.data)).catch(s=>d(s.response?.status))}).catch(()=>window.location.href="/")},[]);const j=t=>{c.post("/api/uniform_inspection/0/get_user_inspection_results_simplified",{inspection_id:t}).then(s=>{let a={};s.data.remarks.map(r=>{a[r.component_id]=r}),u(a),p(s.data),h(Array.from(s.data.checked).map(r=>`${r.component_field_id}`))}).catch(s=>d(s.response?.status))};return e.jsxs("div",{className:"uniform-inspection-user",children:[e.jsx("h2",{children:"My Uniform Inspections Results"}),e.jsxs("div",{children:[e.jsx("section",{children:e.jsx("div",{children:o.length>0?o.map(t=>e.jsxs(f.Fragment,{children:[e.jsx("input",{type:"radio",name:"inspection_selection",id:t.id,onChange:()=>j(t.id)}),e.jsxs("label",{htmlFor:t.id,children:[e.jsx("p",{title:"Inspection Date",children:t?.date}),e.jsx("p",{title:"Inspection Score",children:t?.total_score})]})]},t.id)):e.jsx("p",{children:"No inspection results"})})}),e.jsx("hr",{}),e.jsx("section",{children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{children:"Date"}),e.jsx("p",{children:i?.details?.date}),e.jsx("p",{children:"Assessor"}),e.jsx("p",{children:i?.details?.assessor_name}),e.jsx("p",{children:"Score"}),e.jsx("p",{children:i?.details?.total_score})]}),i?.headings.map(t=>e.jsxs("div",{children:[e.jsx("h3",{children:t?.component_name}),e.jsx("ul",{children:Array.from(i?.subheadings).filter(s=>s.uniform_component_id==t.id).map(s=>e.jsxs("li",{children:[e.jsx("input",{type:"checkbox",disabled:!0,id:`sub-${s.id}`,checked:m.includes(`${s.id}`),className:`${s.description.toLowerCase().includes("missing")?"field-missing":""}`}),e.jsx("label",{htmlFor:`sub-${s.id}`,children:s?.description})]},`${t.id}-${s.id}`))}),e.jsx("textarea",{name:`${t?.component_name}-remarks`,placeholder:"Components Remarks (if any)",defaultValue:x[t.id]?.remarks??"No Remarks Given",disabled:!0})]},t.id))]}):e.jsx("p",{children:"Click on an inspection to view results"})})]})]})}export{w as UniformInspectionUser};
